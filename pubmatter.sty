\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{pubmatter}[2024/10/27 v1.0.0 Publication metadata management]

% This file was originally generated by Claude 3.5.

\RequirePackage{xparse}
\RequirePackage{etoolbox}
\RequirePackage{xkeyval}

% Define keys for author metadata
\define@key{author}{literal}{\def\@temp@literal{#1}}
\define@key{author}{given}{\def\@temp@given{#1}}
\define@key{author}{family}{\def\@temp@family{#1}}
\define@key{author}{dropping-particle}{\def\@temp@droppingparticle{#1}}
\define@key{author}{non-dropping-particle}{\def\@temp@nondroppingparticle{#1}}
\define@key{author}{url}{\def\@temp@url{#1}}
\define@key{author}{email}{\def\@temp@email{#1}}
\define@key{author}{phone}{\def\@temp@phone{#1}}
\define@key{author}{fax}{\def\@temp@fax{#1}}
\define@key{author}{orcid}{\def\@temp@orcid{#1}}
\define@key{author}{note}{\def\@temp@note{#1}}
\define@key{author}{acknowledgements}{\def\@temp@acknowledgements{#1}}
\define@key{author}{corresponding}[true]{\def\@temp@corresponding{#1}}
\define@key{author}{equal-contributor}[true]{\def\@temp@equalcontributor{#1}}
\define@key{author}{deceased}[true]{\def\@temp@deceased{#1}}
\define@key{author}{affiliations}{\def\@temp@affiliations{#1}}

% Define keys for affiliation metadata
\define@key{affiliation}{name}{\def\@temp@affname{#1}}
\define@key{affiliation}{department}{\def\@temp@department{#1}}
\define@key{affiliation}{group}{\def\@temp@group{#1}}
\define@key{affiliation}{address}{\def\@temp@address{#1}}
\define@key{affiliation}{city}{\def\@temp@city{#1}}
\define@key{affiliation}{region}{\def\@temp@region{#1}}
\define@key{affiliation}{country}{\def\@temp@country{#1}}
\define@key{affiliation}{postal-code}{\def\@temp@postalcode{#1}}
\define@key{affiliation}{url}{\def\@temp@affurl{#1}}

% Initialize storage for authors and affiliations
\newcount\@authorcount
\@authorcount=0
\newcount\@affiliationcount
\@affiliationcount=0

% Create commands to store metadata
\NewDocumentCommand{\authordef}{m m}{%
  \global\advance\@authorcount by 1
  \expandafter\def\csname author@#1@number\endcsname{\the\@authorcount}%
  \expandafter\def\csname author@#1@id\endcsname{#1}%
  \setkeys{author}{#2}%
  \ifx\@temp@literal\@undefined\else
  \expandafter\def\csname author@#1@literal\endcsname{\@temp@literal}%
  \fi
  \ifx\@temp@email\@undefined\else
  \expandafter\def\csname author@#1@email\endcsname{\@temp@email}%
  \fi
  \ifx\@temp@affiliations\@undefined\else
  \expandafter\def\csname author@#1@affiliations\endcsname{\@temp@affiliations}%
  \fi
  % Store other fields similarly...
}

\NewDocumentCommand{\affiliationdef}{m m}{%
  \global\advance\@affiliationcount by 1
  \expandafter\def\csname affiliation@#1@number\endcsname{\the\@affiliationcount}%
  \expandafter\def\csname affiliation@#1@id\endcsname{#1}%
  \setkeys{affiliation}{#2}%
  \ifx\@temp@affname\@undefined\else
  \expandafter\def\csname affiliation@#1@name\endcsname{\@temp@affname}%
  \fi
  % Store other fields similarly...
}

% Create commands to retrieve metadata
\NewDocumentCommand{\getauthorfield}{m m}{%
  \csname author@#1@#2\endcsname
}

\NewDocumentCommand{\getaffiliationfield}{m m}{%
  \csname affiliation@#1@#2\endcsname
}

% Helper command to check if author has a field
\NewDocumentCommand{\ifauthorhas}{m m m m}{%
  \ifcsname author@#1@#2\endcsname
  #3%
  \else
  #4%
  \fi
}

% Helper command to check if affiliation has a field
\NewDocumentCommand{\ifaffiliationhas}{m m m m}{%
  \ifcsname affiliation@#1@#2\endcsname
  #3%
  \else
  #4%
  \fi
}

\NewDocumentCommand{\authorname}{m}{%
  \ifauthorhas{#1}{literal}{\getauthorfield{#1}{literal}}{\getauthorfield{#1}{given} \getauthorfield{#1}{family}}%
}

% Command to print all author information
\NewDocumentCommand{\printauthorinfo}{m}{%
  \authorname{#1}%
  \ifauthorhas{#1}{email}{%
    \\\texttt{\getauthorfield{#1}{email}}%
  }{}%
  \ifauthorhas{#1}{affiliations}{%
    \\\emph{Affiliations: \getauthorfield{#1}{affiliations}}%
  }{}%
}

% Example usage:
% \authordef{joey}{
%   literal={Joey Carpinelli},
%   email={joey@carpinelli.email},
%   affiliations={univ1,lab2}
% }
% \affiliationdef{univ1}{name={Example University}}
% \affiliationdef{lab2}{name={Example Lab}}
% \printauthorinfo{joey}

\endinput
